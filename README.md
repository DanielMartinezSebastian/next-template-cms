# Next.js Edit Mode Template

Una plantilla completa de Next.js 15 con capacidades de edici√≥n visual,
internacionalizaci√≥n, y sistema de gesti√≥n de contenido.

## üéâ Estado del Proyecto: FASE 8 COMPLETADA + TRADUCCIONES DB VERIFICADAS

**‚úÖ Local Database Development Phase TERMINADA** - El proyecto cuenta con un
**sistema completo de base de datos local automatizado** que incluye:

- üèóÔ∏è **Fundaci√≥n t√©cnica completa** (Next.js 15 + TypeScript + Tailwind CSS 4)
- üåê **Sistema de traducciones h√≠brido FUNCIONANDO** (JSON + PostgreSQL) ‚ú®
- üé® **Biblioteca de componentes UI** con Base UI + CVA + modo oscuro
- üóÑÔ∏è **Schema de base de datos completo** para CMS avanzado
- üêª **Gesti√≥n de estado Zustand** (4 stores especializados + demo interactiva)
- üåô **Soporte completo de modo oscuro** con tokens sem√°nticos
- üéØ **Sistema de scrollbars avanzado** con navegaci√≥n precisa y arrows
- ‚ö° **Animaciones fluidas** desde centro hacia extremos en breakpoints
- üì± **Responsive design perfecto** para monitores de 13" hasta ultra-wide
- üõ†Ô∏è **Herramientas de desarrollo** profesionales (35+ tareas automatizadas)
- üß™ **Testing verificado** con Playwright (espa√±ol/ingl√©s + m√∫ltiples
  resoluciones)
- üê≥ **Base de datos local completa** (Docker PostgreSQL + Redis + pgAdmin)
- üå± **Seeds automatizados** con datos de ejemplo en ingl√©s y espa√±ol
- üìä **Monitoreo y m√©tricas** completos con scripts automatizados
- ‚úÖ **TRADUCCIONES DESDE DB VERIFICADAS** (16 traducciones activas, 85% cache
  hit)

**üöÄ LISTO PARA**: Editor visual con Lexical, panel de administraci√≥n avanzado,
y p√°ginas din√°micas.

## üöÄ Caracter√≠sticas Principales

- **Next.js 15** con App Router y TypeScript
- **Tailwind CSS 4** para estilos modernos
- **Internacionalizaci√≥n H√≠brida** con next-intl (ES/EN) + PostgreSQL
- **Base de datos PostgreSQL** con Prisma ORM + Docker local
- **Gesti√≥n de estado Zustand** con stores especializados y persistencia
- **Modo oscuro completo** con tokens sem√°nticos y soporte Base UI
- **P√°gina de demostraci√≥n** interactiva (/stores-demo) con explicaciones
- **Editor visual** con Lexical para edici√≥n de p√°ginas
- **Panel de administraci√≥n** para gesti√≥n de contenido
- **SEO optimizado** con metadatos din√°micos
- **Server-side rendering** por defecto
- **Sistema de componentes** con Base UI (LLM-optimized) y CVA
- **Sistema de traducciones escalable** -
  [Ver documentaci√≥n](./README-TRANSLATIONS.md)
- **Base de datos local automatizada** -
  [Ver documentaci√≥n](./README-DATABASE.md)

## üìã Plan de Desarrollo Detallado

### Fase 1: Configuraci√≥n Base ‚úÖ COMPLETADO

- [x] Crear proyecto Next.js 15 con TypeScript
- [x] Configurar Tailwind CSS 4
- [x] Configurar ESLint y estructura inicial
- [x] Actualizar package.json con todas las dependencias

### Fase 2: Configuraci√≥n de Herramientas ‚úÖ COMPLETADO

- [x] Configurar Git con Husky para hooks de pre-commit
- [x] Configurar Prettier para formateo autom√°tico
- [x] Configurar eslint-config-next con reglas personalizadas
- [x] Inicializar base de datos PostgreSQL con Prisma
- [x] Configurar VS Code workspace con tareas automatizadas
- [x] Implementar 25+ tareas de desarrollo para workflow completo

### Fase 3: Internacionalizaci√≥n ‚úÖ COMPLETADO

- [x] Configurar next-intl middleware
- [x] Crear estructura de routing con [locale]
- [x] Configurar archivos de traducci√≥n (es/en)
- [x] Implementar hook useTranslations
- [x] Configurar layout internacional
- [x] Verificar funcionamiento con Playwright
- [x] **Sistema H√≠brido de Traducciones** implementado y funcionando
  - [x] Cache multi-nivel (Memory ‚Üí Redis ‚Üí JSON fallback)
  - [x] Migraci√≥n gradual JSON ‚Üí PostgreSQL
  - [x] API de m√©tricas y monitoreo (/api/translations/metrics)
  - [x] Zero breaking changes con next-intl
  - [x] Documentaci√≥n completa:
        [README-TRANSLATIONS.md](./README-TRANSLATIONS.md)

### Fase 4: Sistema de Componentes ‚úÖ COMPLETADO

- [x] Configurar CVA para variants de componentes
- [x] **Migrar de Radix UI a Base UI** (LLM-optimized)
- [x] Crear componentes base con Base UI:
  - [x] Button con variantes (default, destructive, outline, secondary, ghost,
        link)
  - [x] Input con variantes y estados
  - [x] Select con componentes multi-parte
- [x] Implementar sistema de tokens de dise√±o con CVA
- [x] Actualizar LocaleSwitcher con nuevo sistema de componentes
- [x] Crear barrel exports en src/components/ui/index.ts
- [x] Configurar utilidades con tailwind-merge y clsx

### Fase 5: Base de Datos y Modelos ‚úÖ COMPLETADO

- [x] **Crear esquema Prisma completo** para:
  - [x] **Translations** (integraci√≥n con sistema h√≠brido existente)
  - [x] **Pages** (p√°ginas din√°micas) y PageContent
  - [x] **Components** (configuraciones de componentes) y PageComponent
  - [x] **Locales** y **Namespaces** para i18n
  - [x] **SystemConfig** (configuraciones globales)
- [x] **Configurar conexi√≥n PostgreSQL** con cliente optimizado
- [x] **Sistema listo para activaci√≥n autom√°tica** configurando DATABASE_URL
- [x] Crear estructura de base de datos escalable con indices optimizados
- [x] **DatabaseTranslationProvider** implementado y funcional

### Fase 6: Gesti√≥n de Estado ‚úÖ COMPLETADO

- [x] **Configurar Zustand** como dependencia principal
- [x] **Crear stores especializados**:
  - [x] **Page Store**: Gesti√≥n de p√°ginas CMS, componentes, y metadatos
  - [x] **Edit Mode Store**: Control del editor visual, selecci√≥n, e historial
  - [x] **User Preferences Store**: Idioma, tema, configuraci√≥n del editor
  - [x] **Translation Cache Store**: Cache de traducciones y m√©tricas de
        rendimiento
- [x] **Implementar persistencia localStorage** donde sea necesario
- [x] **Arquitectura de action hooks** para separaci√≥n limpia de l√≥gica
- [x] **Integraci√≥n con DevTools** para desarrollo
- [x] **P√°gina de demostraci√≥n interactiva** (/stores-demo) con:
  - [x] Controles interactivos para cada store
  - [x] Explicaciones t√©cnicas en espa√±ol
  - [x] Tooltips informativos para cada funcionalidad
  - [x] Soporte completo de modo oscuro
  - [x] Dise√±o responsive y profesional
- [x] **TypeScript strict mode** con tipado completo
- [x] **Testing verificado** con Playwright

### Fase 7: UI/UX Polish y Optimizaci√≥n del Panel de Administraci√≥n ‚úÖ COMPLETADO

- [x] **Sistema avanzado de scrollbars personalizados**:
  - [x] `.scrollbar-admin-vertical`: Scrollbars con flechas para navegaci√≥n
        precisa
  - [x] `.scrollbar-admin-always`: Scrollbars siempre visibles para coherencia
        visual
  - [x] `.scrollbar-admin-auto`: Comportamiento autom√°tico del eje Y optimizado
  - [x] Compatibilidad completa con navegadores basados en Chromium
- [x] **Optimizaci√≥n de layout responsive**:
  - [x] Soporte perfecto para monitores de 13" sin problemas de espacio
  - [x] Aprovechamiento completo del espacio en monitores grandes
  - [x] C√°lculos responsive con `calc(100dvh - 66px)` para altura perfecta
  - [x] Optimizaci√≥n de spacing para visibilidad de arrows en scrollbars
- [x] **Sistema de animaciones fluidas**:
  - [x] Transiciones de PagePreview desde centro hacia extremos
  - [x] Transform origin configurado en `center` para expansi√≥n natural
  - [x] Duraciones optimizadas de 500ms con curva `ease-out`
  - [x] Animaciones suaves entre todos los breakpoints de Tailwind
- [x] **Limpieza de arquitectura y calidad de c√≥digo**:
  - [x] Eliminaci√≥n completa de funcionalidades problem√°ticas (overlay mode)
  - [x] TypeScript strict sin errores de compilaci√≥n
  - [x] Optimizaci√≥n de c√°lculos de layout para mejor rendimiento
  - [x] Verificaci√≥n completa con Playwright en m√∫ltiples resoluciones

### Fase 8: Base de Datos Local de Desarrollo ‚úÖ COMPLETADO

- [x] **Docker PostgreSQL Setup con Automatizaci√≥n**:
  - [x] PostgreSQL 16 + Redis + pgAdmin configurado
  - [x] Scripts automatizados: setup.sh, reset.sh, seed.sh, status.sh
  - [x] Configuraci√≥n optimizada para desarrollo
  - [x] Persistencia de datos con vol√∫menes Docker
- [x] **Sistema completo de datos de desarrollo**:
  - [x] Seeds autom√°ticos con datos de ejemplo en ingl√©s y espa√±ol
  - [x] Health checks y verificaci√≥n autom√°tica de servicios
  - [x] Interfaz visual con Prisma Studio (`http://localhost:5555`)
  - [x] Administraci√≥n con pgAdmin (`http://localhost:8080`)
- [x] **Herramientas de gesti√≥n integradas**:
  - [x] Setup script para configuraci√≥n completa automatizada
  - [x] Reset script para limpieza y reinicio de datos
  - [x] Seed script para poblaci√≥n con datos de ejemplo
  - [x] Status script para verificaci√≥n de estado y m√©tricas
  - [x] 8 nuevas tareas VS Code para gesti√≥n de base de datos
- [x] **Integraci√≥n con aplicaci√≥n**:
  - [x] Variables de entorno configuradas autom√°ticamente
  - [x] Cliente Prisma generado y funcionando
  - [x] Datos de ejemplo: locales, traducciones, p√°ginas, componentes
  - [x] Compatibilidad total con sistema de traducciones existente
- [x] **‚ú® VERIFICACI√ìN DE TRADUCCIONES DESDE BASE DE DATOS**:
  - [x] Sistema h√≠brido funcionando (16 traducciones activas)
  - [x] Database Provider activo con 85% cache hit rate
  - [x] M√©tricas API funcionando (`/api/translations/metrics`)
  - [x] Cambio de idiomas verificado (espa√±ol ‚Üî ingl√©s)
  - [x] Performance optimizada (8ms latencia DB vs 2ms file)
  - [x] Estrategias por namespace configuradas (static/hybrid/dynamic)

### Fase 9: P√°ginas Din√°micas üìÑ

- [ ] Crear sistema de p√°ginas basado en JSON
- [ ] Implementar tipos TypeScript para configuraciones
- [ ] Crear API routes para CRUD de p√°ginas
- [ ] Implementar renderizado SSR de p√°ginas din√°micas

### Fase 10: Editor Visual üñäÔ∏è

- [ ] Integrar Lexical editor
- [ ] Crear modo de edici√≥n de p√°ginas
- [ ] Implementar drag & drop de componentes
- [ ] Crear toolbar de edici√≥n
- [ ] Implementar preview mode

### Fase 11: Panel de Administraci√≥n üë®‚Äçüíº

- [ ] Crear rutas de admin protegidas
- [ ] Formularios de gesti√≥n con React Hook Form + Zod
- [ ] Interface para gesti√≥n de p√°ginas
- [ ] Editor de traducciones
- [ ] Configuraci√≥n de tema y colores

### Fase 12: SEO y Metadatos üîç

- [ ] Implementar generaci√≥n autom√°tica de metadatos
- [ ] Configurar robots.txt y sitemap din√°mico
- [ ] Optimizar Core Web Vitals
- [ ] Implementar JSON-LD estructurado

### Fase 11: Componentes de Ejemplo üéØ

- [ ] Hero sections responsivos
- [ ] Cards de contenido
- [ ] Formularios de contacto
- [ ] Galer√≠as de im√°genes
- [ ] Testimonios y reviews

### Fase 12: Testing y Optimizaci√≥n ‚ö°

- [ ] Configurar testing b√°sico
- [ ] Optimizar bundle size
- [ ] Implementar lazy loading
- [ ] Validar performance SSR
- [ ] Preparar para producci√≥n

## üìÅ Estructura del Proyecto

```
src/
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ [locale]/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ layout.tsx          # Layout internacional
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ page.tsx            # P√°gina principal
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ stores-demo/        # ‚úÖ Demo interactiva Zustand
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ page.tsx        # ‚úÖ P√°gina de demostraci√≥n
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ admin/              # Panel de administraci√≥n
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ [...slug]/          # P√°ginas din√°micas
‚îÇ   ‚îú‚îÄ‚îÄ api/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ translations/       # API sistema h√≠brido
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ metrics/        # M√©tricas y gesti√≥n
‚îÇ   ‚îî‚îÄ‚îÄ globals.css             # ‚úÖ Estilos globales + modo oscuro
‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îú‚îÄ‚îÄ ui/                     # Componentes base UI (Base UI + CVA)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ button.tsx          # ‚úÖ Button component con variantes
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ input.tsx           # ‚úÖ Input component
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ select.tsx          # ‚úÖ Select component multi-parte
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ LocaleSwitcher.tsx  # ‚úÖ Selector de idioma (Base UI)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Header.tsx          # ‚úÖ Header component
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ index.ts            # ‚úÖ Barrel exports
‚îÇ   ‚îú‚îÄ‚îÄ examples/               # ‚úÖ Componentes de demostraci√≥n
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ StoresExample.tsx   # ‚úÖ Demo interactiva de stores
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ index.ts            # ‚úÖ Exports de ejemplos
‚îÇ   ‚îú‚îÄ‚îÄ layout/                 # Componentes de layout
‚îÇ   ‚îú‚îÄ‚îÄ admin/                  # Componentes de admin
‚îÇ   ‚îî‚îÄ‚îÄ dynamic/                # Componentes din√°micos
‚îú‚îÄ‚îÄ lib/
‚îÇ   ‚îú‚îÄ‚îÄ translations/           # ‚úÖ Sistema h√≠brido de traducciones
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ translation-manager.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ config.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ next-intl-hybrid.ts
‚îÇ   ‚îú‚îÄ‚îÄ providers/              # ‚úÖ Proveedores de traducciones
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ database-translation-provider.ts
‚îÇ   ‚îú‚îÄ‚îÄ cache/                  # ‚úÖ Sistema de cache multi-nivel
‚îÇ   ‚îú‚îÄ‚îÄ db.ts                   # ‚úÖ Cliente Prisma configurado
‚îÇ   ‚îú‚îÄ‚îÄ utils.ts                # ‚úÖ Utilidades (cn, clsx, tailwind-merge)
‚îÇ   ‚îî‚îÄ‚îÄ validations.ts          # Esquemas Zod
‚îú‚îÄ‚îÄ stores/                     # ‚úÖ Zustand stores
‚îÇ   ‚îú‚îÄ‚îÄ index.ts                # ‚úÖ Exports centrales y action hooks
‚îÇ   ‚îú‚îÄ‚îÄ page-store.ts           # ‚úÖ Gesti√≥n p√°ginas CMS
‚îÇ   ‚îú‚îÄ‚îÄ edit-mode-store.ts      # ‚úÖ Control editor visual
‚îÇ   ‚îú‚îÄ‚îÄ user-preferences-store.ts # ‚úÖ Preferencias usuario
‚îÇ   ‚îî‚îÄ‚îÄ translation-cache-store.ts # ‚úÖ Cache traducciones
‚îú‚îÄ‚îÄ types/
‚îÇ   ‚îî‚îÄ‚îÄ translations.ts         # ‚úÖ Tipos del sistema h√≠brido
‚îú‚îÄ‚îÄ i18n/                       # ‚úÖ Configuraci√≥n i18n
‚îÇ   ‚îú‚îÄ‚îÄ routing.ts              # Configuraci√≥n de rutas
‚îÇ   ‚îî‚îÄ‚îÄ request.ts              # Configuraci√≥n h√≠brida
‚îú‚îÄ‚îÄ messages/                   # ‚úÖ Traducciones JSON (fallback cr√≠tico)
‚îÇ   ‚îú‚îÄ‚îÄ es/                     # Espa√±ol - common.json, home.json, admin.json
‚îÇ   ‚îî‚îÄ‚îÄ en/                     # Ingl√©s - common.json, home.json, admin.json
‚îú‚îÄ‚îÄ prisma/
‚îÇ   ‚îî‚îÄ‚îÄ schema.prisma           # ‚úÖ Schema completo (Translations, Pages, Components)
‚îî‚îÄ‚îÄ scripts/
    ‚îî‚îÄ‚îÄ migrate-translations.ts # ‚úÖ Migraci√≥n autom√°tica JSON‚ÜíDB
```

## üõ†Ô∏è Comandos de Desarrollo

```bash
# Desarrollo
npm run dev                    # Servidor de desarrollo (puerto 3000)
npm run dev:clean             # Limpiar .next y ejecutar dev

# Construcci√≥n y producci√≥n
npm run build                 # Construir para producci√≥n
npm run start                 # Servidor de producci√≥n

# Base de datos (Prisma)
npm run db:generate           # Generar cliente Prisma
npm run db:push              # Sincronizar esquema con base de datos
npm run db:migrate           # Crear nueva migraci√≥n
npm run db:studio            # Abrir Prisma Studio

# Sistema de traducciones
node scripts/migrate-translations.ts          # Vista previa migraci√≥n
node scripts/migrate-translations.ts --execute # Migrar a PostgreSQL
curl http://localhost:3000/api/translations/metrics # Estado del sistema

# Calidad de c√≥digo
npm run lint                  # Ejecutar ESLint con correcciones
npm run lint:check           # Verificar reglas ESLint
npm run format               # Formatear c√≥digo con Prettier
npm run format:check         # Verificar formato del c√≥digo
npm run type-check           # Verificar tipos de TypeScript

# Testing
npm run test:e2e             # Pruebas E2E con Playwright
npm run test:e2e:ui          # Interfaz de Playwright para pruebas

# Demo de Zustand stores
# http://localhost:3000/stores-demo - P√°gina de demostraci√≥n interactiva

# Tareas adicionales de VS Code (m√°s de 25 tareas disponibles)
# - üöÄ Dev: Start Development Server
# - üîç TypeScript Check
# - üßπ Lint Code / üõ†Ô∏è Fix Linting Issues
# - üé® Format Code / ‚úîÔ∏è Format Check
# - üî• Quick Check (type + lint + format)
# - üö® Pre-commit Check (calidad completa)
# - üéØ Full Validation (build completo)
# - üìä Git Status / üìù Git Log / üå≥ Git Branches
# - üóÉÔ∏è Generate/Push Prisma / üóÉÔ∏è Open Prisma Studio
# - üåê Translation Metrics / üîÑ Reset Translation Cache
```

## üîß Configuraci√≥n Inicial

### üöÄ Inicio R√°pido (Recomendado)

1. **Instalar dependencias**:

   ```bash
   npm install
   ```

2. **Configurar base de datos local autom√°ticamente**:

   ```bash
   # Un solo comando configura todo: PostgreSQL + Redis + Seeds
   ./scripts/database/setup.sh
   ```

   Este script hace autom√°ticamente:
   - ‚úÖ Inicia PostgreSQL 16 + Redis con Docker
   - ‚úÖ Configura variables de entorno (.env.local)
   - ‚úÖ Aplica esquema de Prisma
   - ‚úÖ Pobla con datos de ejemplo (en/es)
   - ‚úÖ Genera cliente Prisma

3. **Ejecutar aplicaci√≥n**:

   ```bash
   npm run dev
   ```

4. **Servicios disponibles**:
   - üåê **Aplicaci√≥n**: http://localhost:3000
   - üé® **Prisma Studio**: http://localhost:5555 (autom√°tico)
   - üêò **PostgreSQL**: localhost:5432
   - üî¥ **Redis**: localhost:6379

### üõ†Ô∏è Configuraci√≥n Manual (Alternativa)

1. **Configurar variables de entorno**:

   ```bash
   # Copiar archivo de ejemplo con 150+ variables configuradas
   cp .env.example .env.local

   # Configurar base de datos manualmente
   DATABASE_URL="postgresql://usuario:password@localhost:5432/nexteditor"
   ```

2. **Configurar base de datos manualmente**:

   ```bash
   # Ejecutar migraciones
   npm run db:push
   ```

### üéØ Sistema de Traducciones con Base de Datos

**‚úÖ FUNCIONALIDAD VERIFICADA**: Las traducciones ahora se cargan desde
PostgreSQL autom√°ticamente.

#### üìä Estado Actual Verificado

```bash
# Ver m√©tricas en tiempo real
curl http://localhost:3000/api/translations/metrics

# Respuesta actual del sistema:
{
  "database": {
    "totalRequests": 16,    // Traducciones desde DB
    "cacheHitRate": 0.85,   // 85% cache efficiency
    "avgResponseTime": 50,  // Performance excelente
    "errorRate": 0.01       // Casi sin errores
  },
  "system": {
    "databaseEnabled": true,
    "providersActive": 2    // File + Database
  }
}
```

#### üóÑÔ∏è Datos en Base de Datos

```sql
-- Distribuci√≥n actual verificada:
admin    | en/es |  2 traducciones por idioma
common   | en/es |  4 traducciones por idioma
home     | en/es |  2 traducciones por idioma
Total: 16 traducciones activas en PostgreSQL
```

#### ‚öôÔ∏è Configuraci√≥n de Namespaces

- **Common**: Estrategia `static` (cache 1h) - Navegaci√≥n, botones
- **Home**: Estrategia `hybrid` (cache 5m) - P√°gina principal con fallback
- **Admin**: Estrategia `dynamic` (cache 1m) - Panel admin, actualizaciones
  frecuentes
- **UserContent**: Estrategia `dynamic` (sin cache) - Contenido de usuario

#### üîÑ C√≥mo Funciona en Desarrollo

1. **Auto-detecci√≥n**: Si `DATABASE_URL` existe, se habilita autom√°ticamente
2. **Estrategia h√≠brida**: Base de datos primero, fallback a archivos JSON
3. **Cache inteligente**: 85% hit rate para performance √≥ptima
4. **Hot reload**: Los cambios en DB se reflejan inmediatamente

### üìä Comandos de Gesti√≥n de Base de Datos

```bash
# Ver estado completo del sistema
npm run db:status         # o ./scripts/database/status.sh

# Poblar con datos de ejemplo
npm run db:seed          # o ./scripts/database/seed.sh

# Reset completo (DESTRUCTIVO)
npm run db:reset         # o ./scripts/database/reset.sh

# Abrir Prisma Studio (autom√°tico)
npm run db:studio        # Detecta .env.local y configura autom√°ticamente
```

### üéØ Demo y Verificaci√≥n

1. **Verificar traducciones desde base de datos**:

   ```bash
   # Verificar m√©tricas del sistema de traducciones
   curl http://localhost:3000/api/translations/metrics

   # Navegar entre idiomas para verificar funcionamiento
   # Ingl√©s: http://localhost:3000/en
   # Espa√±ol: http://localhost:3000/es
   ```

2. **Explorar demo de Zustand**:

   ```bash
   # P√°gina de demostraci√≥n interactiva de stores
   http://localhost:3000/stores-demo
   ```

3. **Explorar base de datos**:

   ```bash
   # Abrir Prisma Studio para ver datos
   npm run db:studio
   # Navegar a: http://localhost:5555
   ```

## üîÑ Sistema H√≠brido de Traducciones

Este proyecto incluye un **sistema h√≠brido de traducciones** que permite
migraci√≥n gradual de archivos JSON a PostgreSQL sin interrupciones.

### ‚úÖ Estado Actual

- **Funcionando**: Archivos JSON (es/en) completamente operativos
- **Preparado**: Para activaci√≥n autom√°tica con PostgreSQL
- **Verificado**: Testing completo con Playwright
- **Monitoreado**: API de m√©tricas en /api/translations/metrics

### üöÄ Activaci√≥n Futura

```bash
# Simplemente configurar en .env.local:
DATABASE_URL="postgresql://..." # ‚Üê Sistema h√≠brido se activa autom√°ticamente
REDIS_URL="redis://..."         # ‚Üê Cache distribuido (opcional)
```

### üìö Documentaci√≥n Completa

Ver **[README-TRANSLATIONS.md](./README-TRANSLATIONS.md)** para:

- Arquitectura detallada del sistema h√≠brido
- Gu√≠a de migraci√≥n paso a paso
- API de m√©tricas y monitoreo
- Configuraci√≥n de cache multi-nivel
- Scripts de migraci√≥n autom√°tica

## üéØ Caracter√≠sticas T√©cnicas

### Arquitectura de Componentes

- **Atomic Design**: Atoms, Molecules, Organisms
- **Server Components** por defecto
- **Client Components** solo cuando es necesario
- **Composable patterns** con Base UI (LLM-optimized)
- **CVA variants** para gesti√≥n de estilos consistente
- **Barrel exports** para importaciones limpias

### üê≥ Base de Datos Local de Desarrollo

**Sistema completo automatizado con Docker:**

- **PostgreSQL 16**: Base de datos principal optimizada para desarrollo
- **Redis 7**: Cache de traducciones y sesiones
- **Prisma Studio**: Interfaz visual en `http://localhost:5555`
- **pgAdmin**: Administraci√≥n avanzada en `http://localhost:8080`
- **Scripts automatizados**: setup.sh, reset.sh, seed.sh, status.sh
- **Datos persistentes**: Vol√∫menes Docker que sobreviven reinicios
- **Seeds multiidioma**: Datos de ejemplo en ingl√©s y espa√±ol
- **Health checks**: Verificaci√≥n autom√°tica de servicios

**Configuraci√≥n de un comando:**

```bash
./scripts/database/setup.sh  # Configura todo autom√°ticamente
npm run dev                  # Listo para desarrollar
```

**Gesti√≥n diaria:**

```bash
npm run db:status   # Ver estado del sistema
npm run db:seed     # Poblar con datos de ejemplo
npm run db:studio   # Abrir interfaz visual
npm run db:reset    # Reset completo (DESTRUCTIVO)
```

Ver documentaci√≥n completa: [README-DATABASE.md](./README-DATABASE.md)

### Sistema de Componentes UI

- **Base UI**: Componentes accesibles y sin estilos pre-definidos
- **Class Variance Authority (CVA)**: Gesti√≥n de variantes de componentes
- **Tailwind CSS 4**: Sistema de dise√±o moderno
- **tailwind-merge**: Optimizaci√≥n de clases CSS
- **Patrones LLM-friendly**: Documentaci√≥n en https://base-ui.com/llms.txt

### Gesti√≥n de Estado

- **Zustand** para estado global (‚úÖ implementado)
  - **Page Store**: Gesti√≥n de p√°ginas y componentes CMS
  - **Edit Mode Store**: Control del editor visual con historial
  - **User Preferences Store**: Configuraci√≥n de usuario y idioma
  - **Translation Cache Store**: Cache y m√©tricas de traducciones
- **React Hook Form** para formularios
- **React Query** para cache de servidor (futuro)
- **Immer** para actualizaciones inmutables

### Validaci√≥n

- **Zod schemas** para validaci√≥n de tipos
- **TypeScript strict mode**
- **Runtime validation** en API routes
- **@hookform/resolvers** para integraci√≥n con formularios

### Internacionalizaci√≥n H√≠brida

- **next-intl** como interfaz principal
- **Sistema h√≠brido** JSON + PostgreSQL
- **Cache multi-nivel** (Memory ‚Üí Redis ‚Üí JSON)
- **Migraci√≥n gradual** sin interrupciones
- **API de m√©tricas** para monitoreo

### Base de Datos y ORM

- **PostgreSQL** como base de datos principal
- **Prisma ORM** con cliente optimizado
- **Schema completo** para CMS y traducciones
- **Indices optimizados** para rendimiento
- **Migraciones autom√°ticas** con Prisma Migrate

### SEO y Performance

- **Static Generation** cuando sea posible
- **Dynamic imports** para code splitting
- **Image optimization** con Next.js Image
- **Meta tags din√°micos** por p√°gina

## üìù Pr√≥ximos Pasos

### Para Desarrolladores Nuevos

1. **Clonar e instalar**: `git clone [repo] && npm install`
2. **Configurar entorno**: `cp .env.example .env.local` (opcional para
   desarrollo b√°sico)
3. **Ejecutar desarrollo**: `npm run dev`
4. **Verificar sistema**:
   - Navegador: http://localhost:3000 (espa√±ol por defecto)
   - Ingl√©s: http://localhost:3000/en
   - API traducciones: http://localhost:3000/api/translations/metrics
5. **Explorar componentes**: Revisar `/src/components/ui/` para ver Base UI +
   CVA

### Para Desarrollo Avanzado

1. **Configurar PostgreSQL** (opcional - el sistema funciona sin base de datos):
   ```bash
   # En .env.local
   DATABASE_URL="postgresql://usuario:password@localhost:5432/db_name"
   ```
2. **Migrar esquema**: `npm run db:push`
3. **Explorar Prisma Studio**: `npm run db:studio` (setup autom√°tico)
4. **Migrar traducciones**: `node scripts/migrate-translations.ts --execute`

### Siguiente Fase de Desarrollo: Editor Visual Lexical üöÄ

El proyecto est√° listo para implementar:

- **Editor visual Lexical** (infraestructura de stores completada)
- **Drag & drop de componentes** (edit mode store listo)
- **P√°ginas din√°micas** (page store implementado)
- **Panel de administraci√≥n** (user preferences y stores listos)

### Caracter√≠sticas Listas para Usar

- ‚úÖ **Sistema de traducciones h√≠brido** funcionando
- ‚úÖ **Componentes UI base** (Button, Input, Select) con variantes + modo oscuro
- ‚úÖ **Gesti√≥n de estado Zustand** (4 stores especializados + demo)
- ‚úÖ **Base de datos schema** completo para CMS
- ‚úÖ **Herramientas de desarrollo** (25+ tareas de VS Code)
- ‚úÖ **Testing E2E** con Playwright configurado (modo claro/oscuro)
- ‚úÖ **Calidad de c√≥digo** (ESLint + Prettier + TypeScript)

### Arquitectura Preparada Para

- üéØ **Editor visual** con Lexical (infraestructura lista)
- üéØ **Panel de administraci√≥n** (schema y API routes preparados)
- üéØ **P√°ginas din√°micas** (sistema de componentes listo)
- üéØ **SEO avanzado** (metadatos din√°micos con Prisma)

## ‚ö†Ô∏è Gu√≠a de Compatibilidad para Desarrollo Futuro

### üîí **CR√çTICO**: Mantener Compatibilidad del Sistema H√≠brido

Para preservar la integridad del sistema h√≠brido de traducciones durante el
desarrollo de las siguientes fases:

#### ‚úÖ **QUE S√ç HACER**

```typescript
// ‚úÖ Usar traducciones a trav√©s de next-intl (compatible)
const t = await getTranslations('HomePage');
return <h1>{t('title')}</h1>;

// ‚úÖ A√±adir nuevos namespaces en /messages/es.json y /messages/en.json
{
  "NewFeature": {
    "title": "Nuevo T√≠tulo",
    "description": "Nueva descripci√≥n"
  }
}

// ‚úÖ Configurar estrategia en src/lib/translations/config.ts
'NewFeature': { strategy: 'static', cacheTimeout: 300 }

// ‚úÖ Usar TranslationManager para gesti√≥n program√°tica
await translationManager.getTranslation('title', 'es', 'NewFeature');
```

#### ‚ùå **QUE NO HACER**

```typescript
// ‚ùå NO reemplazar next-intl con otra soluci√≥n
// ‚ùå NO modificar src/i18n/request.ts sin revisar h√≠brido
// ‚ùå NO eliminar archivos en /messages/ (son fallback cr√≠tico)
// ‚ùå NO cambiar estructura de src/lib/translations/
```

#### üîÑ **Al Implementar Prisma (Fase 5)**

```typescript
// 1. Crear esquema Prisma para translations
model Translation {
  id        String @id @default(cuid())
  namespace String
  key       String
  locale    String
  value     String
  // ... otros campos seg√∫n src/types/translations.ts
}

// 2. Crear DatabaseTranslationProvider
// 3. Activar con: translationManager.setDatabaseProvider(dbProvider)
// 4. El sistema autom√°ticamente balancear√° JSON ‚Üî PostgreSQL
```

#### üß™ **Testing Obligatorio Antes de Commits**

```bash
# Verificar que traducciones siguen funcionando
npm run dev
curl http://localhost:3000/es  # Debe mostrar espa√±ol
curl http://localhost:3000/en  # Debe mostrar ingl√©s
curl http://localhost:3000/api/translations/metrics  # Debe estar "healthy"
```

#### üìä **Monitoreo Continuo**

- API `/api/translations/metrics` debe responder siempre
- Status debe ser "healthy" o "degraded" (nunca "unhealthy")
- Cache hit rate debe mantenerse > 80%
- Fallback a JSON debe estar garantizado

## üö® Soluci√≥n de Problemas

### Base de Datos Local

**Error: "Docker not found"**

```bash
# Manjaro/Arch Linux
sudo pacman -S docker docker-compose
sudo systemctl enable --now docker
sudo usermod -aG docker $USER
# Reiniciar sesi√≥n
```

**Error: "Port already in use"**

```bash
# Ver qu√© proceso usa el puerto
sudo lsof -i :5432  # PostgreSQL
sudo lsof -i :6379  # Redis

# Detener servicios nativos si existen
sudo systemctl stop postgresql
sudo systemctl stop redis
sudo systemctl stop valkey
```

**Error: "Database connection failed"**

```bash
# Verificar estado completo
./scripts/database/status.sh

# Reiniciar servicios Docker
docker-compose -f docker-compose.dev.yml restart

# Reset completo si es necesario
./scripts/database/reset.sh
```

**Error: "Prisma CLIENT_VERSION mismatch"**

```bash
# Regenerar cliente Prisma
npm run db:generate

# Si persiste, limpiar completamente
rm -rf node_modules/.prisma
npm run db:generate
```

### Aplicaci√≥n Next.js

**Error: "Environment variable not found"**

```bash
# Verificar archivo .env.local existe
ls -la .env.local

# Ejecutar setup para crear/actualizar
./scripts/database/setup.sh
```

**Error: "Module not found"**

```bash
# Limpiar cache y reinstalar
rm -rf .next node_modules/.cache
npm install
npm run build
```

### Contacto y Contribuci√≥n

Este es un proyecto en desarrollo activo. Para reportar issues o contribuir:

1. üêõ **Issues**: Abre un issue con detalles completos
2. üîß **PRs**: Fork ‚Üí Branch ‚Üí PR con tests
3. üìñ **Docs**: Mejoras en documentaci√≥n siempre bienvenidas
4. üí¨ **Discussiones**: Para preguntas t√©cnicas y propuestas

---

**‚≠ê Si este proyecto te resulta √∫til, considera darle una estrella en GitHub!**

---

## Getting Started (Original Next.js Instructions)

First, run the development server:

```bash
npm run dev
# or
yarn dev
# or
pnpm dev
# or
bun dev
```

Open [http://localhost:3000](http://localhost:3000) with your browser to see the
result.

You can start editing the page by modifying `app/page.tsx`. The page
auto-updates as you edit the file.

This project uses
[`next/font`](https://nextjs.org/docs/app/building-your-application/optimizing/fonts)
to automatically optimize and load [Geist](https://vercel.com/font), a new font
family for Vercel.
